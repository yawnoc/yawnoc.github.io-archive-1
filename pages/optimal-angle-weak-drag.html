<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="author" content="Conway">
<meta name="description" content="A derivation of the optimal launch angle (which maximises range) for projectile motion in weak quadratic drag using perturbation theory.">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<link rel="stylesheet" href="/conway.min.css">
<link rel="stylesheet" href="/conway-katex.min.css">
<script defer src="/conway-katex.min.js"></script>
<script defer src="/conway-render.min.js"></script>
<title>Projectile motion: optimal launch angle for weak quadratic drag — Conway's site</title>
</head>
<body onload="dateRender(); mathsRender();">
<header><nav><ul>
<li><a href="/" title="Home page">Home</a></li>
<li><a href="#" title="Jump back to top">Top</a></li>
<li><a href="#solution" title="Solution">Solution</a></li>
<li><a href="#result" title="Skip to the result">Result</a></li>
<li><a href="#numerics" title="Numerical verification">Numerics</a></li>
<li><a href="#cite" title="Cite this page">Cite</a></li>
</ul></nav></header>
<h1>Projectile motion: optimal launch angle for weak quadratic drag</h1>
<p class="page-properties">
First created:&nbsp;20190621<br>
Last modified:&nbsp;<b>20190918</b><br>
<b>See also:</b>&nbsp;<a href="/pages/optimal-angle-platform.html" title="Projectile motion: optimal launch angle from a platform">Projectile motion: optimal launch angle from a platform</a>
</p>
<p>
In the absence of air resistance, a launch angle of 45° maximises range.
When there is drag linear in speed, the equations of motion can be integrated
analytically, and closed-form expressions in terms of the
<a href="http://mathworld.wolfram.com/LambertW-Function.html" title="Lambert W-Function">Lambert <span class="maths">W</span> function</a>
can be obtained for the optimal launch angle; see
<a href="https://www.researchgate.net/publication/228851314_Projectile_Motion_with_Resistance_and_the_Lambert_W_Function" title="Projectile Motion with Resistance and the Lambert W Function">Packel &amp;&nbsp;Yuen (2004)</a>.
However, a more realistic model of air resistance
has drag proportional to the <strong>square</strong> of speed,
for which the equations of motion are nonlinear and
analytic solutions cannot be obtained.
</p>
<p>
In high school there was this rather horrible investigation where
we had to (experimentally) compare the optimal launch angle of
a golf ball and a ping-pong ball.
At the time I believed that nothing much could be done in terms of modelling
other than solving the equations of motion numerically,
but back then I knew nothing of scaling and perturbation theory.
Now armed with some basic knowledge of these very useful tools,
I have been able to derive an expansion for the optimal launch angle
when air resistance is relatively weak.
</p>
<span class="maths embedded-definitions">
  \gdef\po#1{\color{grey} {} + O \!\left( #1 \right)}
</span>
<svg class="embedded-styles"><style>
text {
font-family: sans-serif;
text-anchor: middle;
}
@font-face {
font-display: swap;
font-family: "KaTeX_Math-Italic";
src:
url("/fonts/KaTeX_Math-Italic.woff2") format("woff2"),
url("/fonts/KaTeX_Math-Italic.woff") format("woff"),
url("/fonts/KaTeX_Math-Italic.ttf") format("truetype");
}
@font-face {
font-display: swap;
font-family: "KaTeX_Main-Regular";
src:
url("/fonts/KaTeX_Main-Regular.woff2") format("woff2"),
url("/fonts/KaTeX_Main-Regular.woff") format("woff"),
url("/fonts/KaTeX_Main-Regular.ttf") format("truetype");
}
.maths-italic {
font-family: "KaTeX_Math-Italic", "KaTeX_Main-Regular";
}
.maths-roman {
font-family: "KaTeX_Main-Regular";
}
line, polyline {
stroke:        black;
vector-effect: non-scaling-stroke;
}
polyline {
fill: none;
}
polyline.points {
fill:   none;
stroke: none;
}
</style></svg>
<h2 id="solution"><a class="self-link" href="#solution"></a>
Solution
</h2>
<p>
<b>Manuscript:</b>
<a href="/manuscripts/resistance.pdf" title="Manuscript for Projectile motion: optimal launch angle for weak quadratic drag"><code>resistance.pdf</code>&nbsp;(983&nbsp;KB)</a>
</p>
<div class="centred-svg">
<svg class="fit-width" width="360px" viewBox="-2 -9 14 10">
<defs>
<marker id="arrowhead" viewBox="0 -0.3 1 0.6"
refX="1" refY="0"
markerWidth="1" markerHeight="0.3"
orient = "auto-start-reverse">
<path d="M 0, -0.3 L 0, 0.3 L 1, 0 z"/>
</marker>
</defs>
<line x1="0" y1="0" x2="11" y2="0"/>
<text class="maths-italic" x="11" y="0" font-size="0.8" dx="0.6em" dy="0.3em">x</text>
<line x1="0" y1="0" x2="0" y2="-8"/>
<text class="maths-italic" x="0" y="-8" font-size="0.8" dy="-0.5em">y</text>
<polyline points="0,-0
0.245110995009268,-0.4861517187099219
0.4801816778208002,-0.9442990762404092
0.7061283410059535,-1.376564718270853
0.9237540146997104,-1.784803909709473
1.133766485868184,-2.17064684000858
1.336792869363945,-2.535532833557729
1.533391492313122,-2.880738253952923
1.724061663894877,-3.20739944609674
1.909251765092096,-3.516531737366786
2.089365991982065,-3.809045282034206
2.264770011055041,-4.085758356967491
2.435795728634328,-4.347408584369548
2.602745333652655,-4.594662456963978
2.76589474023019,-4.828123464253595
2.925496531134009,-5.048339059200991
3.081782483421603,-5.255806658574985
3.234965742026746,-5.450978834089852
3.38524269473549,-5.634267822993407
3.532794592180965,-5.806049464193965
3.677788948603188,-5.966666648049691
3.820380752758038,-6.116432353591867
3.960713513205941,-6.255632335466698
4.098920158033827,-6.384527513683672
4.235123805694466,-6.503356111905964
4.369438420967384,-6.612335584157149
4.501969367979156,-6.711664365160388
4.632813870727246,-6.801523475823584
4.762061390617189,-6.882078012407363
4.889793930152557,-6.953478545430908
5.016086272118472,-7.015862452134082
5.141006164361472,-7.069355204043503
5.264614461531801,-7.114071628578432
5.386965236775468,-7.150117160367124
5.508105878083932,-7.17758909375813
5.628077185443655,-7.196577842761952
5.746913485592883,-7.207168208426642
5.864642780596629,-7.209440646820895
5.981286944232264,-7.203472524073881
6.096861976266584,-7.189339339232466
6.211378319423947,-7.167115891986404
6.324841237895225,-7.136877371261181
6.437251250535266,-7.098700342475037
6.548604607319247,-7.052663615519793
6.658893794768655,-6.998848981418945
6.768108055095087,-6.937341812106284
6.876233904530815,-6.868231523899972
6.983255638249318,-6.791611910344956
7.089155811874273,-6.70758135383282
7.1939156923393,-6.616242927759631
7.297515673437696,-6.517704402129121
7.399935653588117,-6.412078165726036
7.501155375062937,-6.299481077559179
7.601154725192267,-6.180034259454105
7.699914000927657,-6.05386284065242
7.797414138703765,-5.921095664180707
7.89363691185142,-5.78186496367088
7.988565097959823,-5.636306018292383
8.082182618613752,-5.484556792517172
8.174474653884809,-5.326757566587363
8.265427733863735,-5.163050562790394
8.355029809403963,-4.993579571960725
8.443270304118396,-4.81848958401205
8.530140149540232,-4.637926425751409
8.61563180522962,-4.452036408728777
8.699739265483609,-4.26096598942619
8.782458054188535,-4.06486144368398
8.863785209242026,-3.863868556893695
8.943719257866137,-3.658132331154653
9.022260184033234,-3.447796710290666
9.099409389131933,-3.233004323353309
9.175169646910954,-3.013896246996092
9.249545053654039,-2.790611786888482
9.322540974458599,-2.563288278148248
9.394163986414355,-2.33206090460384
9.464421819405738,-2.097062536553843
9.533323295193004,-1.858423586566768
9.600878265361974,-1.61627188276009
9.667097548670762,-1.370732558911131
9.731992868263907,-1.121927960682738
9.79557678916998,-0.8699775671923655
9.857862656447724,-0.6149979271126464
9.918864534298352,-0.3571026084636498
9.978597146417505,-0.09640216124025217
9.999999999999998,-1.12021820651121e-015
"/>
<text class="maths-italic" x="1.2" y="-0.1" font-size="0.8" dx="-0.5em" dy="-0.35em">ϕ</text>
<text class="maths-italic" x="10" y="0" font-size="0.8" dy="1em">R</text>
<line x1="0" y1="0" x2="1" y2="-2" marker-end="url(#arrowhead)"/>
<text class="maths-italic" x="1" y="-2" font-size="0.8" dx="-0.6em">u</text>
</svg>
</div>
<h3 id="motion"><a class="self-link" href="#motion"></a>
Equations of motion
</h3>
<p>
Suppose a projectile of mass <span class="maths">m</span> is launched at
speed <span class="maths">u</span> and angle <span class="maths">\phi</span> from the ground,
which has gravitational field strength <span class="maths">g</span>,
and let there be drag proportional to the square of the projectile's speed,
with constant of proportionality <span class="maths">b</span>.
Let dots denote time derivatives.
The drag force on the projectile has magnitude
<span class="maths">b \| \dot{\vec{x}} \|^2</span>, and it acts
in the direction opposite to the projectile's velocity,
i.e.&nbsp;in the direction <span class="maths">-\dot{\vec{x}} / \| \dot{\vec{x}} \|</span>.
Therefore the drag force is <span class="maths">-b \dot{\vec{x}} \| \dot{\vec{x}} \|</span>,
and so in components the equations of motion are
</p>
<div class="maths">
\begin{alignedat}{4}
  m \ddot{x} &amp;=      &amp;&amp; - b \dot{x} \sqrt{\dot{x}^2 + \dot{y}^2},
    \quad &amp; \dot{x} (0) &amp;= u \cos\phi, \quad &amp; x (0) &amp;= 0, \\
  m \ddot{y} &amp;= -m g &amp;&amp; - b \dot{y} \sqrt{\dot{x}^2 + \dot{y}^2},
    \quad &amp; \dot{y} (0) &amp;= u \sin\phi, \quad &amp; y (0) &amp;= 0.
\end{alignedat}
</div>
<h3 id="scaling"><a class="self-link" href="#scaling"></a>
Scaling
</h3>
<p>
Since we shall be making a perturbation from the dragless <span class="maths">b = 0</span> case,
it is appropriate to choose the length scale and time scale thereof.
In the dragless case the mass <span class="maths">m</span> is irrelevant,
and the only parameters are the initial speed <span class="maths">u</span>
and gravitational acceleration <span class="maths">g</span>, yielding the length scale
</p>
<div class="maths">
L = u^2 / g
</div>
<p>
and the time scale
</p>
<div class="maths">
T = u / g.
</div>
<p>
Therefore we put <span class="maths">\hat{x} = x / L</span>,
<span class="maths">\hat{y} = y / L</span> and <span class="maths">\hat{t} = t / T</span> to obtain
scaled (dimensionless) variables <span class="maths">\hat{x}</span>,
<span class="maths">\hat{y}</span> and <span class="maths">\hat{t}</span>.
Dropping the hats, the equations of motion become
</p>
<div class="maths">
\begin{alignedat}{4}
  \ddot{x} &amp;=    &amp;&amp; - B \dot{x} \sqrt{\dot{x}^2 + \dot{y}^2},
    \quad &amp; \dot{x} (0) &amp;= \cos\phi, \quad &amp; x (0) &amp;= 0, \\
  \ddot{y} &amp;= -1 &amp;&amp; - B \dot{y} \sqrt{\dot{x}^2 + \dot{y}^2},
    \quad &amp; \dot{y} (0) &amp;= \sin\phi, \quad &amp; y (0) &amp;= 0,
\end{alignedat}
</div>
<p>where</p>
<div class="maths">
B = \frac{b u^2}{m g}
</div>
<p>
is the initial drag-to-weight ratio,
the only dimensionless group in the problem.
By definition, the projectile's terminal speed <span class="maths">c</span> is given by
</p>
<div class="maths">
1 = \frac{b c^2}{m g}.
</div>
<p>
Dividing these, we see that
</p>
<div class="maths">
B = \left( \frac{u}{c} \right)^2.
</div>
<p>
Now the optimal angle is dimensionless, so it can depend only on
the sole dimensionless group <span class="maths">B</span>.
Thus, <strong>the optimal angle depends only on <span class="maths">\sqrt{B} = u / c</span>,
the ratio between the initial and terminal speeds</strong>.
(I wish I knew this back in Year&nbsp;12.)
</p>
<h3 id="perturbation"><a class="self-link" href="#perturbation"></a>
Perturbed trajectory
</h3>
<p>
By "weak drag" I mean that <span class="maths">B \ll 1</span>, i.e.&nbsp;<span class="maths">u^2 \ll c^2</span>.
We make an asymptotic expansion in powers of <span class="maths">B</span> about <span class="maths">B = 0</span>:
</p>
<div class="maths">
\begin{aligned}
  \dot{x} &amp;= \dot{x}_0 + B \dot{x}_1 + B^2 \dot{x}_2 \po{B^3} \\
  \dot{y} &amp;= \dot{y}_0 + B \dot{y}_1 + B^2 \dot{y}_2 \po{B^3}
\end{aligned}
</div>
<p>
Substituting these into the equations of motion and doing some algebra,
we obtain
</p>
<div class="maths">
\begin{alignedat}{2}
  \ddot{x}_0 + B \ddot{x}_1 + B^2 \ddot{x}_2 &amp;=
    &amp;&amp; - B \big[ \dot{x}_0 v_0 \big]
    - B^2 \left[ \dot{x}_1 v_0 + \frac{\dot{x}_0 w_1}{v_0} \right]
    \po{B^3}, \\
  \ddot{y}_0 + B \ddot{y}_1 + B^2 \ddot{y}_2 &amp;=
    - 1
    &amp;&amp; - B \big[ \dot{y}_0 v_0 \big]
    - B^2 \left[ \dot{y}_1 v_0 + \frac{\dot{y}_0 w_1}{v_0} \right]
    \po{B^3},
\end{alignedat}
</div>
<p>where</p>
<div class="maths">
\begin{aligned}
  v_0 &amp;= \sqrt{{\dot{x}_0}^2 + {\dot{y}_0}^2}, \\
  w_1 &amp;= \dot{x}_0 \dot{x}_1 + \dot{y}_0 \dot{y}_1.
\end{aligned}
</div>
<p>
Equating coefficients of <span class="maths">B</span>, we obtain
</p>
<div class="maths">
\begin{alignedat}{4}
  \ddot{x}_0 &amp;= {} &amp;  0 &amp;,
    \quad &amp; \dot{x}_0 (0) &amp;= \cos\phi, \quad &amp; x_0 (0) &amp;= 0, \\
  \ddot{y}_0 &amp;= {} &amp; -1 &amp;,
    \quad &amp; \dot{y}_0 (0) &amp;= \sin\phi, \quad &amp; y_0 (0) &amp;= 0,
\end{alignedat}
</div>
<div class="maths">
\begin{alignedat}{3}
  \ddot{x}_1 &amp;= -\dot{x}_0 v_0,
    \quad &amp; \dot{x}_1 (0) &amp;= 0, \quad &amp; x_1 (0) &amp;= 0, \\
  \ddot{y}_1 &amp;= -\dot{y}_0 v_0,
    \quad &amp; \dot{y}_1 (0) &amp;= 0, \quad &amp; y_1 (0) &amp;= 0,
\end{alignedat}
</div>
<div class="maths">
\begin{alignedat}{3}
  \ddot{x}_2 &amp;= -\left[ \dot{x}_1 v_0 + \frac{\dot{x}_0 w_1}{v_0} \right],
    \quad &amp; \dot{x}_2 (0) &amp;= 0, \quad &amp; x_2 (0) &amp;= 0, \\
  \ddot{y}_2 &amp;= -\left[ \dot{y}_1 v_0 + \frac{\dot{y}_0 w_1}{v_0} \right],
    \quad &amp; \dot{y}_2 (0) &amp;= 0, \quad &amp; y_2 (0) &amp;= 0,
\end{alignedat}
</div>
<div class="maths">
\text{etc.}
</div>
<p>
Thus <span class="maths">\dot{x}_0, x_0, \dot{y}_0, y_0, \dot{x}_1,
  \text{etc.}</span> can be determined by straight integration,
although the expressions become very complicated (see
<a href="/manuscripts/resistance.pdf" title="Manuscript for Projectile motion: optimal launch angle for weak quadratic drag">manuscript</a>
for details).
For brevity, we define the following:
</p>
<div class="maths">
\begin{aligned}
  \alpha &amp;= \cos\phi \\
   \beta &amp;= \sin\phi \\
    \tau &amp;= t - \beta \\
       r &amp;= \frac{\tau + v_0}{-\beta + 1}
\end{aligned}
</div>
<p>
Note that <span class="maths">v_0 = \sqrt{\alpha^2 + \tau^2}</span>.
After a lot of algebra and integration, we obtain:
</p>
<div class="maths">
\begin{aligned}
  \ddot{x}_0 &amp;= 0 \\[0.2em]
   \dot{x}_0 &amp;= \alpha \\[0.2em]
         x_0 &amp;= \alpha t
\end{aligned}
</div>
<div class="maths">
\begin{aligned}
  \ddot{y}_0 &amp;= -1 \\[0.2em]
   \dot{y}_0 &amp;= -\tau \\[0.2em]
         y_0 &amp;= -\tfrac{1}{2} \tau^2 + \tfrac{1}{2} \beta^2
\end{aligned}
</div>
<div class="maths">
\begin{aligned}
  \ddot{x}_1 &amp;= -\alpha v_0 \\[0.2em]
   \dot{x}_1 &amp;=
    - \Big[ \tfrac{1}{2} \alpha \beta \Big]
    - \Big[ \tfrac{1}{2} \alpha \Big] \tau v_0
    - \Big[ \tfrac{1}{2} \alpha^3 \Big] \log r
    \\[0.4em]
  x_1 &amp;=
    - \Big[ \tfrac{1}{3} \alpha \Big]
    - \Big[ \tfrac{1}{2} \alpha \beta \Big] \tau
    + \Big[ \tfrac{1}{2} \alpha^3 \Big] v_0
    - \Big[ \tfrac{1}{6} \alpha \Big] {v_0}^3
    - \Big[ \tfrac{1}{2} \alpha^3 \Big] \tau \log r
\end{aligned}
</div>
<div class="maths">
\begin{aligned}
  \ddot{y}_1 &amp;= \tau v_0 \\[0.2em]
   \dot{y}_1 &amp;= \tfrac{1}{3} {v_0}^3 - \tfrac{1}{3} \\[0.4em]
         y_1 &amp;=
      \Big[ {-\tfrac{1}{4}} + \tfrac{1}{8} \alpha^2 \Big] \beta
    - \Big[ \tfrac{1}{3} \Big] \tau
    + \Big[ \tfrac{1}{8} \alpha^2 \Big] \tau v_0
    + \Big[ \tfrac{1}{12} \Big] \tau {v_0}^3
    + \Big[ \tfrac{1}{8} \alpha^4 \Big] \log r
\end{aligned}
</div>
<div class="maths">
\begin{aligned}
  \ddot{x}_2 &amp;=
      \Big[ \tfrac{4}{3} \alpha^3 \Big] \tau
    + \Big[ \tfrac{5}{6} \alpha \Big] \tau^3
    + \Big[ \tfrac{1}{2} \alpha^3 \beta \Big] \frac{1}{v_0}
    - \Big[ \tfrac{1}{3} \alpha \Big] \frac{\tau}{v_0}
    + \Big[ \tfrac{1}{2} \alpha \beta \Big] v_0
    + \Big[ \tfrac{1}{2} \alpha^5 \Big] \frac{\log r}{v_0} \\ &amp; \quad
    + \Big[ \tfrac{1}{2} \alpha^3 \Big] v_0 \log r
    \\[0.4em]
  \dot{x}_2 &amp;=
      \Big[
        \tfrac{3}{8} \alpha - \tfrac{3}{8} \alpha^3 + \tfrac{1}{3} \alpha^5
      \Big]
    + \Big[ \tfrac{13}{24} \alpha^3 \Big] \tau^2
    + \Big[ \tfrac{5}{24} \alpha \Big] \tau^4
    - \Big[ \tfrac{1}{3} \alpha \Big] v_0
    + \Big[ \tfrac{1}{4} \alpha \beta \Big] \tau v_0 \\ &amp; \quad
    + \Big[ \tfrac{3}{4} \alpha^3 \beta \Big] \log r
    + \Big[ \tfrac{1}{4} \alpha^3 \Big] \tau v_0 \log r
    + \Big[ \tfrac{3}{8} \alpha^5 \Big] \log^2 r
    \\[0.4em]
  x_2 &amp;=
      \Big[
        \tfrac{1}{6} \alpha + \tfrac{4}{9} \alpha^3 + \tfrac{8}{9} \alpha^5
      \Big] \beta
    + \Big[
        \tfrac{3}{8} \alpha - \tfrac{3}{8} \alpha^3 + \alpha^5
      \Big] \tau
    + \Big[ \tfrac{11}{72} \alpha^3 \Big] \tau^3
    + \Big[ \tfrac{1}{24} \alpha \Big] \tau^5 \\ &amp; \quad
    - \Big[ \tfrac{3}{4} \alpha^3 \beta \Big] v_0
    - \Big[ \tfrac{1}{6} \alpha \Big] \tau v_0
    + \Big[ \tfrac{1}{12} \alpha \beta \Big] {v_0}^3
    - \Big[ \tfrac{1}{6} \alpha^3 \Big] \log r
    + \Big[ \tfrac{3}{4} \alpha^3 \beta \Big] \tau \log r \\ &amp; \quad
    - \Big[ \tfrac{3}{4} \alpha^5 \Big] v_0 \log r
    + \Big[ \tfrac{1}{12} \alpha^3 \Big] {v_0}^3 \log r
    + \Big[ \tfrac{3}{8} \alpha^5 \Big] \tau \log^2 r
\end{aligned}
</div>
<div class="maths">
\begin{aligned}
  \ddot{y}_2 &amp;=
    - \Big[ \tfrac{1}{3} \alpha^4 \Big]
    - \Big[ \tfrac{3}{2} \alpha^2 \Big] \tau^2
    - \Big[ \tfrac{2}{3} \Big] \tau^4
    + \Big[ \tfrac{1}{3} \Big] v_0
    - \Big[ \tfrac{1}{2} \alpha^2 \beta \Big] \frac{\tau}{v_0}
    + \Big[ \tfrac{1}{3} \Big] \frac{\tau^2}{v_0}
    - \Big[ \tfrac{1}{2} \alpha^4 \Big] \frac{\tau \log r}{v_0}
    \\[0.4em]
  \dot{y}_2 &amp;=
      \Big[
        \tfrac{1}{5} + \tfrac{4}{15} \alpha^2 + \tfrac{8}{15} \alpha^4
      \Big] \beta
    + \Big[ \tfrac{1}{6} \alpha^4 \Big] \tau
    - \Big[ \tfrac{1}{2} \alpha^2 \Big] \tau^3
    - \Big[ \tfrac{2}{15} \Big] \tau^5
    - \Big[ \tfrac{1}{2} \alpha^2 \beta \Big] v_0
    + \Big[ \tfrac{1}{3} \Big] \tau v_0 \\ &amp; \quad
    - \Big[ \tfrac{1}{2} \alpha^4 \Big] v_0 \log r
    \\[0.4em]
  y_2 &amp;=
      \Big[
        \tfrac{1}{9} - \tfrac{1}{8} \alpha^2 + \tfrac{1}{8} \alpha^4
      - \tfrac{2}{9} \alpha^6
      \Big]
    + \Big[
        \tfrac{1}{5} + \tfrac{4}{15} \alpha^2 + \tfrac{8}{15} \alpha^4
      \Big] \beta \tau
    + \Big[ \tfrac{5}{24} \alpha^4 \Big] \tau^2
    - \Big[ \tfrac{1}{8} \alpha^2 \Big] \tau^4 \\ &amp; \quad
    - \Big[ \tfrac{1}{45} \Big] \tau^6
    - \Big[ \tfrac{1}{4} \alpha^2 \beta \Big] \tau v_0
    + \Big[ \tfrac{1}{9} \Big] {v_0}^3
    - \Big[ \tfrac{1}{4} \alpha^4 \beta \Big] \log r
    - \Big[ \tfrac{1}{4} \alpha^4 \Big] \tau v_0 \log r \\ &amp; \quad
    - \Big[ \tfrac{1}{8} \alpha^6 \Big] \log^2 r
\end{aligned}
</div>
<p>
You might be wondering why I stopped at order <span class="maths">B^2</span>.
Initially I thought that integration could be performed to arbitrary order
(although the amount of algebra required grows <i>very</i> quickly).
However I was wrong; it turns out that the following integrals
appear at cubic order, which have no closed-form expression:
</p>
<div class="maths">
\begin{aligned}
  &amp;
  \int
    \frac{
      \tau \log \big( \tau + \sqrt{\alpha^2 + \tau^2} \big)
    }{
      \alpha^2 + \tau^2
    }
  \td\tau \\[0.4em]
  &amp;
  \int
    \frac{
      \log^2 \big( \tau + \sqrt{\alpha^2 + \tau^2} \big)
    }{
      (\alpha^2 + \tau^2)^{3/2}
    }
  \td\tau
\end{aligned}
</div>
<p>
If you are able to evaluate either of the two integrals above,
please contact me at <code>leeconway@protonmail.com</code>.
On the other hand, quartic terms, even if they could be found,
would be of little practical use, since the expansion is asymptotic
and as such probably does not converge.
</p>
<h3 id="time"><a class="self-link" href="#time"></a>
Flight time
</h3>
<p>
Having determined the trajectory, we then determine the flight time,
given by <span class="maths">y (t) = 0</span>.
To quadratic order, i.e.&nbsp;with
<span class="maths">y = y_0 + B y_1 + B^2 y_2 \po{B^3}</span> and
<span class="maths">t = t_0 + B t_1 + B^2 t_2 \po{B^3}</span>, this becomes
</p>
<div class="maths">
\begin{aligned}
  y_0 (t_0)
  &amp; + B \big[ t_1 \dot{y}_0 (t_0) + y_1 (t_0) \big] \\
  &amp; + B^2
    \Big[
      t_2 \dot{y}_0 (t_0)
    + \tfrac{1}{2} {t_1}^2 \ddot{y}_0 (t_0)
    + t_1 \dot{y}_1 (t_0)
    + y_2 (t_0)
    \Big] \po{B^3} = 0.
\end{aligned}
</div>
<p>
The unperturbed (dragless) flight time is given by the positive solution to
<span class="maths">y_0 (t_0) = 0</span>, which is
</p>
<div class="maths">
t_0 = 2 \beta.
</div>
<p>
From the linear and quadratic terms we obtain
</p>
<div class="maths">
\begin{aligned}
  t_1 &amp;= y_1 (t_0) \big/ {-\dot{y}_0 (t_0)}, \\[0.2em]
  t_2 &amp;=
    \Big[
      \tfrac{1}{2} {t_1}^2 \ddot{y}_0 (t_0)
    + t_1 \dot{y}_1 (t_0)
    + y_2 (t_0)
    \Big] \Big/ {-\dot{y}_0 (t_0)},
\end{aligned}
</div>
<p>
which, after some more algebra, reduce to
</p>
<div class="maths">
\begin{aligned}
  t_1 &amp;=
    \Big[ {-\tfrac{1}{2}} + \tfrac{\alpha^2}{4} \Big]
  + \Big[ \tfrac{1}{8} \alpha^4 \Big] \frac{\log\rho}{\beta}, \\[0.4em]
  t_2 &amp;=
    \Big[
      \tfrac{11}{40}
    - \tfrac{29}{120} \alpha^2
    + \tfrac{481}{480} \alpha^4
    - \tfrac{16}{15} \alpha^6
    \Big] \frac{1}{\beta}
  + \Big[
      {-\tfrac{7}{16} \alpha^4}
    + \tfrac{15}{32} \alpha^6
    \Big] \frac{\log\rho}{\beta^2} \\ &amp; \quad
  + \Big[
      {-\tfrac{1}{8} \alpha^6}
    + \tfrac{15}{128} \alpha^8
    \Big] \frac{\log^2\rho}{\beta^3},
\end{aligned}
</div>
<p>where</p>
<div class="maths">
\rho = \frac{1 + \beta}{1 - \beta}.
</div>
<p>
By now, <span class="maths">t_0, t_1, t_2</span> are just functions of <span class="maths">\phi</span>
(remember <span class="maths">\alpha</span> and <span class="maths">\beta</span> are abbreviations
for <span class="maths">\cos\phi</span> and <span class="maths">\sin\phi</span>).
</p>
<h3 id="range"><a class="self-link" href="#range"></a>
Range
</h3>
<p>
To quadratic order, the range is
</p>
<div class="maths">
\begin{aligned}
  R
  &amp;= x (t) \\
  &amp;=
  x_0 (t_0)
  + B \big[ t_1 \dot{x}_0 (t_0) + x_1 (t_0) \big]
  + B^2
    \Big[
      t_2 \dot{x}_0 (t_0)
    + t_1 \dot{x}_1 (t_0)
    + x_2 (t_0)
    \Big] \po{B^3} \\
  &amp;= R_0 + B R_1 + B^2 R_2 \po{B^3},
\end{aligned}
</div>
<p>
where, after some more algebra,
</p>
<div class="maths">
\begin{aligned}
  R_0 &amp;= 2 \alpha \beta, \\[0.2em]
  R_1 &amp;=
    \Big[ {-\tfrac{3}{2} \alpha} + \tfrac{5}{4} \alpha^3 \Big]
  + \Big[
      {-\tfrac{1}{2} \alpha^3} + \tfrac{5}{8} \alpha^5
    \Big] \frac{\log\rho}{\beta}, \\[0.4em]
  R_2 &amp;=
    \Big[
      \tfrac{51}{40} \alpha
    - \tfrac{757}{360} \alpha^3
    + \tfrac{5243}{1440} \alpha^5
    - \tfrac{128}{45} \alpha^7
    \Big] \frac{1}{\beta} \\ &amp; \quad
  + \Big[
      \tfrac{11}{12} \alpha^3
    - \tfrac{149}{48} \alpha^5
    + \tfrac{71}{32} \alpha^7
    \Big] \frac{\log\rho}{\beta^2}
  + \Big[
      \tfrac{3}{8} \alpha^5
    - \tfrac{15}{16} \alpha^7
    + \tfrac{71}{128} \alpha^9
    \Big] \frac{\log^2\rho}{\beta^3}.
\end{aligned}
</div>
<h3 id="angle"><a class="self-link" href="#angle"></a>
Optimal launch angle
</h3>
<p>
Let primes denote <span class="maths">\phi</span> derivatives.
Then the optimal launch angle is given by <span class="maths">R' (\phi) = 0</span>,
or, to quadratic order,
</p>
<div class="maths">
\begin{aligned}
  R'_0 (\phi_0)
  &amp; + B \big[ \phi_1 R''_0 (\phi_0) + R'_1 (\phi_0) \big] \\
  &amp; + B^2
    \Big[
      \phi_2 R''_0 (\phi_0)
    + \tfrac{1}{2} {\phi_1}^2 R'''_0 (\phi_0)
    + \phi_1 R''_1 (\phi_0)
    + R'_2 (\phi_0)
    \Big] \po{B^3} = 0.
\end{aligned}
</div>
<p>
From the constant term, <span class="maths">R'_0 (\phi_0) = 2 \cos (2 \phi_0) = 0</span>,
yielding the familiar
</p>
<div class="maths">
\phi_0 = \frac{\pi}{4}
</div>
<p>
in the absence of air resistance.
From the linear and quadratic terms we obtain
</p>
<div class="maths">
\begin{aligned}
  \phi_1 &amp;= R'_1 (\phi_0) \big/ {-R''_0 (\phi_0)}, \\[0.2em]
  \phi_2 &amp;=
    \Big[
      \tfrac{1}{2} {\phi_1}^2 R'''_0 (\phi_0)
    + \phi_1 R''_1 (\phi_0)
    + R'_2 (\phi_0)
    \Big] \Big/ {-R''_0 (\phi_0)},
\end{aligned}
</div>
<p>
which, after a lot of differentiation and yet more algebra, become
</p>
<div class="maths">
\begin{aligned}
  \phi_1 &amp;= -\tfrac{3}{32} \sqrt{2} + \tfrac{1}{64} p, \\[0.2em]
  \phi_2 &amp;=
    -\tfrac{1393}{3840} + \tfrac{81}{512} p \sqrt{2} + \tfrac{17}{2048} p^2,
\end{aligned}
</div>
<p>where</p>
<div class="maths">
p
= \log \tfrac{1 + 1 / \sqrt{2}}{1 - 1 / \sqrt{2}}
= 2 \tanh^{-1} \tfrac{1}{\sqrt{2}}.
</div>
<h2 id="result"><a class="self-link" href="#result"></a>
Result
</h2>
<p>
For small initial drag-to-weight ratios
(or small initial-to-terminal kinetic energy ratios)
</p>
<div class="maths">
B = \frac{b u^2}{m g} = \frac{u^2}{c^2} \ll 1,
</div>
<p>
the <b>optimal launch angle</b> has the <b>asymptotic expansion</b>
</p>
<div class="maths">
\boxed{
  \phi = \phi_0 + B \phi_1 + B^2 \phi_2 \po{B^3},
}
</div>
<p>where</p>
<div class="maths">
\begin{aligned}
  \phi_0
    &amp;= \tfrac{\pi}{4} \\
    &amp;= 45 \degree, \\[0.2em]
  \phi_1
    &amp;=
    - \tfrac{3}{32} \sqrt{2}
    + \tfrac{1}{64} \log \tfrac{1 + 1 / \sqrt{2}}{1 - 1 / \sqrt{2}} \\
    &amp;= -6.018 \degree, \\[0.2em]
  \phi_2
    &amp;=
    - \tfrac{1393}{3840}
    + \tfrac{81}{512} \sqrt{2} \log \tfrac{1 + 1 / \sqrt{2}}{1 - 1 / \sqrt{2}}
    + \tfrac{17}{2048} \log^2 \tfrac{1 + 1 / \sqrt{2}}{1 - 1 / \sqrt{2}} \\
    &amp;= 3.290 \degree,
\end{aligned}
</div>
<p>that is,</p>
<div class="maths">
  \boxed{
  \begin{aligned}
    \phi
    &amp;= 45 \degree - 6.018 \degree B + 3.290 \degree B^2 \po{B^3} \\
    &amp;= 45 \degree
    - 6.018 \degree \frac{u^2}{c^2}
    + 3.290 \degree \frac{u^4}{c^4} \po{\frac{u^6}{c^6}}.
  \end{aligned}
}
</div>
<h2 id="numerics"><a class="self-link" href="#numerics"></a>
Numerical verification
</h2>
<p>
In the following table we compare numerically computed optimal launch angles
(see <a href="#code" title="Code (GNU Octave)">code below</a>)
with those from the asymptotic <a href="#result" title="Result">result above</a>:
</p>
<div class="centred-flex"><div class="overflowing"><table>
<tr>
<td class="no-border"></td>
<th colspan="3">Optimal <span class="maths">\phi</span></th>
</tr>
<tr>
<th><span class="maths">B</span></th>
<th>Numerical</th>
<th>Asymptotic</th>
<th>Rel.&nbsp;error</th>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0</td>
<td>45.0°</td>
<td>45.0°</td>
<td>&numsp;0</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.1</td>
<td>44.4°</td>
<td>44.4°</td>
<td>&numsp;0.005%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.2</td>
<td>43.9°</td>
<td>43.9°</td>
<td>&numsp;0.04%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.3</td>
<td>43.4°</td>
<td>43.5°</td>
<td>&numsp;0.1%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.4</td>
<td>43.0°</td>
<td>43.1°</td>
<td>&numsp;0.3%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.5</td>
<td>42.6°</td>
<td>42.8°</td>
<td>&numsp;0.5%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.6</td>
<td>42.2°</td>
<td>42.6°</td>
<td>&numsp;0.8%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.7</td>
<td>41.9°</td>
<td>42.4°</td>
<td>&numsp;1.2%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.8</td>
<td>41.6°</td>
<td>42.3°</td>
<td>&numsp;1.7%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;0.9</td>
<td>41.3°</td>
<td>42.2°</td>
<td>&numsp;2.4%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;1</td>
<td>41.0°</td>
<td>42.3°</td>
<td>&numsp;3.2%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;2</td>
<td>38.8°</td>
<td>46.1°</td>
<td>19%</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;3</td>
<td>37.3°</td>
<td class="not-applicable" rowspan="16" colspan="2"></td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;4</td>
<td>36.2°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;5</td>
<td>35.3°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;6</td>
<td>34.6°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;7</td>
<td>34.0°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;8</td>
<td>33.5°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;&numsp;9</td>
<td>33.0°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;10</td>
<td>32.6°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;15</td>
<td>31.1°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;20</td>
<td>30.1°</td>
</tr>
<tr>
<td>&numsp;&numsp;&numsp;50</td>
<td>27.1°</td>
</tr>
<tr>
<td>&numsp;&numsp;100</td>
<td>25.2°</td>
</tr>
<tr>
<td>&numsp;&numsp;200</td>
<td>23.5°</td>
</tr>
<tr>
<td>&numsp;&numsp;500</td>
<td>22.9°</td>
</tr>
<tr>
<td>&numsp;1000</td>
<td>19.7°</td>
</tr>
<tr>
<td>10000</td>
<td>18.1°</td>
</tr>
</table></div></div>
<p>
Indeed the asymptotic expansion is very accurate for <span class="maths">B &lt; 0.5</span>
(or equivalently <span class="maths">u / c &lt; 0.7</span>).
</p>
<div class="centred-svg">
<svg class="fit-width" width="480px" viewBox="-2.5 -48 25.5 16">
<defs>
<marker id="htickcoarse" viewBox="-0.1 0 0.2 0.4"
refX="0" refY="0" markerWidth="0.2" markerHeight="0.4">
<line x1="0" y1="0" x2="0" y2="0.4"/>
</marker>
<marker id="htickfine" viewBox="-0.1 0 0.2 0.25"
refX="0" refY="0" markerWidth="0.2" markerHeight="0.25">
<line x1="0" y1="0" x2="0" y2="0.25"/>
</marker>
<marker id="vtickcoarse" viewBox="-0.4 -0.1 0.4 0.2"
refX="0" refY="0" markerWidth="0.4" markerHeight="0.2">
<line x1="-0.4" y1="0" x2="0" y2="0"/>
</marker>
<marker id="vtickfine" viewBox="-0.25 -0.1 0.25 0.2"
refX="0" refY="0" markerWidth="0.25" markerHeight="0.2">
<line x1="-0.25" y1="0" x2="0" y2="0"/>
</marker>
</defs>
<line x1="0" y1="-35" x2="21" y2="-35"/>
<text class="maths-italic" x="21" y="-35" font-size="1" dx="0.6em" dy="0.3em">B</text>
<polyline class="points" points="0,-35 4,-35 8,-35 12,-35 16,-35 20,-35"
marker-start="url(#htickcoarse)"
marker-mid="url(#htickcoarse)"
marker-end="url(#htickcoarse)"/>
<text class="maths-italic" x="0" y="-35" font-size="1" dy="1.35em">0</text>
<text class="maths-italic" x="4" y="-35" font-size="1" dy="1.35em">1</text>
<text class="maths-italic" x="8" y="-35" font-size="1" dy="1.35em">2</text>
<text class="maths-italic" x="12" y="-35" font-size="1" dy="1.35em">3</text>
<text class="maths-italic" x="16" y="-35" font-size="1" dy="1.35em">4</text>
<text class="maths-italic" x="20" y="-35" font-size="1" dy="1.35em">5</text>
<polyline class="points"
points="0.8,-35 1.6,-35 2.4,-35 3.2,-35 4.8,-35 5.6,-35 6.4,-35 7.2,-35
8.8,-35 9.6,-35 10.4,-35 11.2,-35 12.8,-35 13.6,-35 14.4,-35 15.2,-35
16.8,-35 17.6,-35 18.4,-35 19.2,-35 20.8,-35"
marker-start="url(#htickfine)"
marker-mid="url(#htickfine)"
marker-end="url(#htickfine)"/>
<line x1="0" y1="-35" x2="0" y2="-46.8"/>
<text class="maths-italic" x="0" y="-46.8" font-size="1" dy="-0.5em">ϕ</text>
<polyline class="points"
points="0,-35 0,-40 0,-45"
marker-start="url(#vtickcoarse)"
marker-mid="url(#vtickcoarse)"
marker-end="url(#vtickcoarse)"/>
<text class="maths-italic" x="0" y="-35" font-size="1" dx="-1.4em" dy="0.3em">35°</text>
<text class="maths-italic" x="0" y="-40" font-size="1" dx="-1.4em" dy="0.3em">40°</text>
<text class="maths-italic" x="0" y="-45" font-size="1" dx="-1.4em" dy="0.3em">45°</text>
<polyline class="points"
points="0,-36 0,-37 0,-38 0,-39 0,-41 0,-42 0,-43 0,-44 0,-46"
marker-start="url(#vtickfine)"
marker-mid="url(#vtickfine)"
marker-end="url(#vtickfine)"/>
<polyline points="0,-45
0.4,-44.4287109375
0.8,-43.912353515625
1.2,-43.44268798828125
1.6,-43.00872802734375
2,-42.60772705078125
2.4,-42.2369384765625
2.8,-41.890869140625
3.2,-41.56951904296875
3.6,-41.2646484375
4,-40.97900390625
4.4,-40.70709228515625
4.8,-40.44891357421875
5.2,-40.20721435546875
5.6,-39.9737548828125
6,-39.7540283203125
6.4,-39.54254150390625
6.8,-39.33929443359375
7.2,-39.144287109375
7.6,-38.96026611328125
8,-38.78173828125
8.4,-38.60870361328125
8.800000000000001,-38.441162109375
9.199999999999999,-38.2818603515625
9.6,-38.1280517578125
10,-37.97698974609375
10.4,-37.83416748046875
10.8,-37.694091796875
11.2,-37.5567626953125
11.6,-37.4249267578125
12,-37.298583984375
12.4,-37.17498779296875
12.8,-37.05413818359375
13.2,-36.93603515625
13.6,-36.82342529296875
14,-36.7108154296875
14.4,-36.60369873046875
14.8,-36.49658203125
15.2,-36.39495849609375
15.6,-36.2933349609375
16,-36.19720458984375
16.40000000000001,-36.10107421875
16.8,-36.00494384765625
17.2,-35.914306640625
17.6,-35.82366943359375
18,-35.738525390625
18.40000000000001,-35.650634765625
18.8,-35.5682373046875
19.2,-35.48583984375
19.6,-35.4034423828125
20,-35.32379150390625
"/>
<text x="10" y="-37.97698974609375" font-size="1" dx="2.5em" dy="-0.5em">Numerical</text>
<polyline points="0,-45
0.2,-44.70730811994633
0.4,-44.43106503807245
0.6000000000000001,-44.17127075437838
0.8,-43.92792526886412
1,-43.70102858152967
1.2,-43.49058069237503
1.4,-43.29658160140019
1.6,-43.11903130860515
1.8,-42.95792981398992
2,-42.81327711755451
2.2,-42.68507321929889
2.4,-42.57331811922309
2.6,-42.47801181732709
2.8,-42.39915431361089
3,-42.3367456080745
3.2,-42.29078570071793
3.4,-42.26127459154115
3.6,-42.24821228054418
3.8,-42.25159876772702
4,-42.27143405308966
4.2,-42.30771813663211
4.4,-42.36045101835437
4.600000000000001,-42.42963269825643
4.800000000000001,-42.51526317633832
5,-42.61734245259998
5.2,-42.73587052704146
5.4,-42.87084739966276
5.600000000000001,-43.02227307046386
5.800000000000001,-43.19014753944476
6,-43.37447080660547
6.2,-43.57524287194598
6.4,-43.79246373546631
6.600000000000001,-44.02613339716643
6.800000000000001,-44.27625185704637
7,-44.54281911510611
7.2,-44.82583517134567
7.4,-45.12530002576502
7.600000000000001,-45.44121367836419
7.800000000000001,-45.77357612914315
8,-46.12238737810192
8.199999999999999,-46.4876474252405
"/>
<text x="8.4" y="-46.8693562705589" font-size="1" dx="-3.5em" dy="1em">Asymptotic</text>
</svg>
</div>
<p>
The true optimal launch angle is a decreasing function of <span class="maths">B</span>.
Thus, very crudely, the asymptotic expansion becomes useless
when it stops decreasing, which occurs at
</p>
<div class="maths">
B \approx \frac{-\phi_1}{2 \phi_2} = 0.9.
</div>
<p>
Finally, here is a plot of the optimal launch angle in terms of
<span class="maths">\sqrt{B} = u / c</span>, the initial-to-terminal speed ratio:
</p>
<div class="centred-svg">
<svg class="fit-width" width="480px" viewBox="-2.5 -48 25.5 21">
<line x1="0" y1="-30" x2="20.5" y2="-30"/>
<text class="maths-italic" x="20.5" y="-30" font-size="1" dx="1.2em" dy="0.3em">u&thinsp;/&thinsp;c</text>
<polyline class="points"
points="0,-30 5,-30 10,-30 15,-30 20,-30"
marker-start="url(#htickcoarse)"
marker-mid="url(#htickcoarse)"
marker-end="url(#htickcoarse)"/>
<text class="maths-italic" x="0" y="-30" font-size="1" dy="1.35em">0</text>
<text class="maths-italic" x="5" y="-30" font-size="1" dy="1.35em">1</text>
<text class="maths-italic" x="10" y="-30" font-size="1" dy="1.35em">2</text>
<text class="maths-italic" x="15" y="-30" font-size="1" dy="1.35em">3</text>
<text class="maths-italic" x="20" y="-30" font-size="1" dy="1.35em">4</text>
<polyline class="points"
points="1,-30 2,-30 3,-30 4,-30 6,-30 7,-30 8,-30 9,-30
11,-30 12,-30 13,-30 14,-30 16,-30 17,-30 18,-30 19,-30"
marker-start="url(#htickfine)"
marker-mid="url(#htickfine)"
marker-end="url(#htickfine)"/>
<line x1="0" y1="-30" x2="0" y2="-46.8"/>
<text class="maths-italic" x="0" y="-46.8" font-size="1" dy="-0.5em">ϕ</text>
<polyline class="points"
points="0,-30 0,-35 0,-40 0,-45"
marker-start="url(#vtickcoarse)"
marker-mid="url(#vtickcoarse)"
marker-end="url(#vtickcoarse)"/>
<text class="maths-italic" x="0" y="-30" font-size="1" dx="-1.4em" dy="0.3em">30°</text>
<text class="maths-italic" x="0" y="-35" font-size="1" dx="-1.4em" dy="0.3em">35°</text>
<text class="maths-italic" x="0" y="-40" font-size="1" dx="-1.4em" dy="0.3em">40°</text>
<text class="maths-italic" x="0" y="-45" font-size="1" dx="-1.4em" dy="0.3em">45°</text>
<polyline class="points"
points="0,-31 0,-32 0,-33 0,-34 0,-36 0,-37 0,-38 0,-39
0,-41 0,-42 0,-43 0,-44 0,-46"
marker-start="url(#vtickfine)"
marker-mid="url(#vtickfine)"
marker-end="url(#vtickfine)"/>
<polyline
points="0,-45
0.5,-44.9395751953125
1,-44.7637939453125
1.5,-44.483642578125
2,-44.11285400390625
2.5,-43.67340087890625
3,-43.17901611328125
3.5,-42.64617919921875
4,-42.09686279296875
4.5,-41.53656005859375
5,-40.97900390625
5.5,-40.4241943359375
6,-39.8858642578125
6.5,-39.3585205078125
7,-38.85040283203125
7.5,-38.36151123046875
8,-37.891845703125
8.500000000000002,-37.43865966796875
9,-37.0074462890625
9.5,-36.59271240234375
10,-36.19720458984375
10.5,-35.8154296875
11,-35.452880859375
11.5,-35.10406494140625
12,-34.76898193359375
12.5,-34.453125
13,-34.1455078125
13.5,-33.848876953125
14,-33.56597900390625
14.5,-33.2940673828125
15,-33.0303955078125
15.5,-32.78045654296875
16,-32.5360107421875
16.5,-32.30255126953125
17,-32.0745849609375
17.5,-31.8603515625
18,-31.64886474609375
18.5,-31.44287109375
19,-31.24786376953125
19.5,-31.058349609375
20,-30.87432861328125
"/>
<text x="10" y="-36.19720458984375" font-size="1" dx="2.5em" dy="-0.5em">Numerical</text>
<polyline points="0,-45
0.25,-44.98497474704055
0.5,-44.94014572013488
0.7500000000000001,-44.86625311520109
1,-44.76453059210267
1.25,-44.63670527464849
1.5,-44.48499775059285
1.75,-44.31212207163537
2,-44.12128575342115
2.25,-43.91618977554063
2.5,-43.70102858152967
2.75,-43.48049007886951
3,-43.2597556389868
3.25,-43.04450009725355
3.5,-42.8408917529872
3.75,-42.65559236945059
4,-42.4957571738519
4.25,-42.36903485734477
4.5,-42.28356757502817
4.75,-42.24799094594655
5,-42.27143405308966
5.25,-42.3635194433927
5.5,-42.53436312773625
5.750000000000001,-42.7945745809463
6.000000000000001,-43.15525674179419
6.25,-43.62800601299671
6.5,-44.22491226121601
6.75,-44.95855881705962
7.000000000000001,-45.84202247508053
7.25,-46.88887349377703
"/>
<text x="7.250000000000001" y="-46.88887349377704" font-size="1" dx="-3.2em" dy="1em">Asymptotic</text>
</svg>
</div>
<h3 id="code"><a class="self-link" href="#code"></a>
Code (GNU Octave)
</h3>
<h4>Trajectories</h4>
<p>
Trajectories are determined using numerical integration:
</p>
<pre>
##  ----------------------------------------------------------------
##  [t_sol, z_sol, r_big] = trajectory (b_big, phi_pd)
##  ----------------------------------------------------------------
##  Determines the trajectory and range for projectile motion where drag is
##  proportional to the square of speed.
##  Input:
##    b_big  is the dimensionless group B == (b u^2) / (m g)
##    phi_pd is the launch angle phi divided by a degree, i.e. phi / degree
##  Output:
##    t_sol  is the column of solution t values
##    z_sol  is the matrix of solution (xdot, ydot, x, y) values
##    r_big  is the range R
##  Note that
##    b   is the drag coefficient
##    g   is the gravitational field strength
##    m   is the mass of the projectile
##    u   is the launch speed
##    phi is the launch angle.
##  The dimensionless group B == (b u^2) / (m g) is the initial drag-to-weight
##  ratio. After scaling by L == u^2 / g and T == u / g (which are the length
##  and time scales in the absence of drag), we get in scaled variables:
##    d/dt (xdot) ==    - B xdot sqrt (xdot^2 + ydot^2), xdot(0) == cos (phi)
##    d/dt (ydot) == -1 - B ydot sqrt (xdot^2 + ydot^2), xdot(0) == sin (phi)
##    d/dt (x)    ==        xdot                       ,    x(0) == 0
##    d/dt (y)    ==        ydot                       ,    y(0) == 0.
##  This is solved using ode45.

function [t_sol, z_sol, r_big] = trajectory (b_big, phi_pd)

  ## Right hand side of system of ODEs in z == (xdot, ydot, x, y)
  fun = @(t, z) [
       - b_big * z(1) * sqrt(z(1)^2 + z(2)^2)
    -1 - b_big * z(2) * sqrt(z(1)^2 + z(2)^2)
                 z(1)
                 z(2)
  ];

  ## Initial values
  t_init = 0;
  z_init = [cosd(phi_pd), sind(phi_pd), 0, 0];

  ## Do not solve system of ODEs in the degenerate case phi == 0
  if (phi_pd == 0)
    t_sol = t_init;
    z_sol = z_init;
    r_big = z_init(3);
    return;
  endif

  ## Suppress termination warning
  warning ("off", "integrate_adaptive:unexpected_termination");

  ## Subfunction event_y_zero is defined below (for detecting y == 0 crossing)
  ## ----------------------------------------------------------------
  ## 1ST PASS: Determine flight time approximately
  ## ----------------------------------------------------------------

  ## Zero-drag flight time 2 sin (phi) is an upper bound
  t_end = 2 * sind (phi_pd);

  ## Time interval for ODE
  t_range = [t_init, t_end];

  ## ODE options structure (keep default time step)
  ode_struct = odeset ("Events", @event_y_zero);

  ## Solve system of ODEs
  [t_sol, z_sol] = ode45 (fun, t_range, z_init, ode_struct);

  ## Flight time
  t_end = t_sol(end);

  ## ----------------------------------------------------------------
  ## 2ND PASS: Use finer step size
  ## ----------------------------------------------------------------

  ## True flight time will probably be within 2/n of the rough flight time
  ## above, where n is the number of steps in the coarse solution above
  t_end = (1 + 2 / length (t_sol)) * t_end;

  ## Time interval for ODE
  t_range = [t_init, t_end];

  ## Maximum time step
  t_step = (t_end - t_init) / 100;

  ## ODE options structure
  ode_struct = odeset ("Events" , @event_y_zero, "MaxStep", t_step);

  ## Solve system of ODEs
  [t_sol, z_sol] = ode45 (fun, t_range, z_init, ode_struct);

  ## Range
  r_big = z_sol(end,3);

  ## Restore termination warning
  warning ("on", "integrate_adaptive:unexpected_termination");

endfunction

## Event function which detects y == 0 crossing

function [value, is_terminal, direction] = event_y_zero (t, z)

  value       = z(4);  # Component 4 of z == (xdot, ydot, x, y)
  is_terminal = true;  # Terminate integration when value == 0
  direction   = -1;    # and value is decreasing

endfunction
</pre>
<p>
The trajectory shown at the top of this page corresponds to <span class="maths">B = 3</span>
and a (non-optimal) launch angle of <span class="maths">\phi = \tan^{-1} (2) = 63.4 \degree</span>.
The list of points (used in the SVG) was generated
using the following script:
</p>
<pre>
b_big  = 3;
phi_pd = atand (2);
[~, z_sol, r_big] = trajectory (b_big, phi_pd);
x_sol = z_sol(:, 3);
y_sol = z_sol(:, 4);
## Scale to order 10 and negate y coordinates for SVG
len   = 0.1 * r_big;
x_sol =  x_sol / len;
y_sol = -y_sol / len;
csvwrite ("trajectory-plot.csv", [x_sol, y_sol]);
</pre>
<h4>Optimal launch angle (numerical)</h4>
<p>
First a range extractor:
</p>
<pre>
##  ----------------------------------------------------------------
##  r_big = range (b_big, phi_pd)
##  ----------------------------------------------------------------
##  Dependencies: trajectory
##  ----------------------------------------------------------------
##  Determines the range for projectile motion where drag is proportional to
##  the square of speed.
##  Input:
##    b_big  is the dimensionless group B == (b u^2) / (m g)
##    phi_pd is the launch angle phi divided by a degree, i.e. phi / degree
##  Output:
##    r_big  is the range R
##  For more details see trajectory.m.

function r_big = range (b_big, phi_pd)

  ## Range
  [~, ~, r_big] = trajectory (b_big, phi_pd);

endfunction
</pre>
<p>
Then an implementation of the bisection algorithm for seeking maxima:
</p>
<pre>
##  ----------------------------------------------------------------
##  x_opt = arg_max_bisection (fun, x_range, abs_tol)
##  ----------------------------------------------------------------
##  Determines maximising argument using the bisection algorithm.
##  Input:
##    fun     is the unimodal function to be maximised
##    x_range is the row of endpoints of the initial search interval in x
##    abs_tol is the absolute tolerance in x (default 1e-4 of the width of
##               x_range)
##  Output:
##    x_opt   is the optimal x
##  At each step, the function is evaluated at the five equally spaced points
##    x_a, x_b, x_c, x_d, x_e
##  to obtain function values
##    f_a, f_b, f_c, f_d, f_e
##  from which the width of the search interval is narrowed by half.

function x_opt = arg_max_bisection (fun, x_range, abs_tol)

  ## Midpoint function
  mid = @(x_1, x_2) (x_1 + x_2) / 2;

  ## Initialise endpoints and midpoint of interval
  x_a = min (x_range);
  x_e = max (x_range);
  x_c = mid (x_a, x_e);

  ## Initialise function values at these points
  f_a = fun (x_a);
  f_e = fun (x_e);
  f_c = fun (x_c);

  ## Set default abs_tol if not supplied
  if (nargin &lt; 3)
    abs_tol = (x_e - x_a) * 1e-4;
  endif

  ## Iterate
  while (abs (x_e - x_a) &gt;= abs_tol)

    ## Quarter and three-quarter points of search interval
    x_b = mid (x_a, x_c);
    x_d = mid (x_c, x_e);

    ## Function values at these points
    f_b = fun (x_b);
    f_d = fun (x_d);

    ## Location (index) where function is maximised among the five points
    ##  ind     ==    1    2    3    4    5
    [~, ind] = max ([f_a, f_b, f_c, f_d, f_e]);

    ## Halve width of search interval
    if     (ind &lt;= 2) # Maximum lies to the left half
      [x_c, x_e] = {x_b, x_c}{:};
      [f_c, f_e] = {f_b, f_c}{:};
    elseif (ind &gt;= 4) # Maximum lies to the right half
      [x_a, x_c] = {x_c, x_d}{:};
      [f_a, f_c] = {f_c, f_d}{:};
    else              # Maximum lies in the central half
      [x_a, x_e] = {x_b, x_d}{:};
      [f_a, f_e] = {f_b, f_d}{:};
    endif

  endwhile

  ## Maximising argument
  x_opt = x_c;

endfunction
</pre>
<p>
These are combined into a function which determines optimal launch angle
for a given <span class="maths">B</span>:
</p>
<pre>
##  ----------------------------------------------------------------
##  phi_pd_opt = optimal_angle (b_big, abs_tol)
##  ----------------------------------------------------------------
##  Dependencies: range, arg_max_bisection
##  ----------------------------------------------------------------
##  Determines the optimal launch angle (which maximises range) for projectile
##  motion where drag is proportional to the square of speed.
##  Input:
##    b_big      is the dimensionless group B == (b u^2) / (m g)
##    abs_tol    is the absolute tolerance in phi_pd
##  Output:
##    phi_pd_opt is the optimal launch angle phi divided by a degree,
##               i.e. phi_opt / degree (default 0.01)
##  For more details see trajectory.m.

function phi_pd_opt = optimal_angle (b_big, abs_tol)

  ## Set default abs_tol if not supplied
  if (nargin &lt; 2)
    abs_tol = 0.01;
  endif

  ## Range as a function of launch angle divided by a degree
  range_fun = @(phi_pd) range (b_big, phi_pd);

  ## Search interval
  phi_pd_range = [0, 90];

  ## Determine optimal angle using bisection
  phi_pd_opt = arg_max_bisection (range_fun, phi_pd_range, abs_tol);

endfunction
</pre>
<p>
More convenient is a function which exports
a table of values given several values of <span class="maths">B</span>:
</p>
<pre>
##  ----------------------------------------------------------------
##  optimal_angle_export (b_big_values, name_suffix)
##  ----------------------------------------------------------------
##  Dependencies: optimal_angle
##  ----------------------------------------------------------------
##  Exports table of optimal launch angles per degree (which maximise range)
##  for projectile motion where drag is proportional to the square of speed.
##  Input:
##    b_big_values are the values of dimensionless group B == (b u^2) / (m g)
##    name_suffix  is the suffix for the filename of the exported table
##  For more details see trajectory.m.

function optimal_angle_export (b_big_values, name_suffix)

  ## Timer on
  tic;

  ## Initialise table entries
  n_max = length (b_big_values);
  table = zeros (n_max, 2);

  ## Filename of table to be exported
  name = ["optimal-angle-", name_suffix, ".csv"];

  ## Initialise progress indicator
  handle = waitbar (0, ["Computing entries for ", name]);

  ## Compute table entries
  for n = 1 : n_max
    ## B
    b_big = b_big_values(n);
    table(n,1) = b_big;
    ## Optimal launch angle per degree
    phi_pd_opt = optimal_angle (b_big);
    table(n,2) = phi_pd_opt;
    ## Progress indicator
    waitbar (n / n_max, handle);
  endfor

  ## Close progress indicator
  close (handle);

  ## Export table
  csvwrite (name, table);

  ## Timer off
  toc;

endfunction
</pre>
<p>
For example, the values in the table above were generated using
the following script, which took 10&nbsp;minutes to run in GNU Octave 4.4.0
on a very old desktop with just 480&nbsp;MB of RAM:
</p>
<pre>
optimal_angle_export (
  [ ...
    0 : 0.1 : 1, ...
    2 : 1   : 10, ...
    15, 20, 50, 100, 200, 500, ...
    10 .^ [3, 4, 6, 8]
  ],
  "table"
);
</pre>
<h4>Optimal launch angle (asymptotic)</h4>
<p>
The following calulates the <span class="maths">B \ll 1</span>
asymptotic launch angle using the <a href="#result" title="Result">result</a> above:
</p>
<pre>
##  ----------------------------------------------------------------
##  phi_pd_opt = optimal_angle_asymptotic (b_big)
##  ----------------------------------------------------------------
##  Determines the asymptotic optimal launch angle (which maximises range)
##  for projectile motion where drag is proportional to the square of speed,
##  but weak.
##  Input:
##    b_big      is the dimensionless group B == (b u^2) / (m g) &lt;&lt; 1
##  Output:
##    phi_pd_opt is the optimal launch angle phi divided by a degree,
##               i.e. phi_opt / degree (default 0.01)
##  For more details see trajectory.m.

function phi_pd_opt = optimal_angle_asymptotic (b_big)

  ## Construct polynomial coefficients to second order
  p = log ((1 + 1 / sqrt (2)) / (1 - 1 / sqrt (2)));
  phi_coeffs = zeros (1, 3);
  phi_coeffs(3) = pi / 4;
  phi_coeffs(2) = - 3/32 * sqrt (2) + 1/64 * p;
  phi_coeffs(1) = - 1393/3840 + 81/512 * sqrt (2) * p + 17/2048 * p^2;

  ## Evaluate
  phi_pd_opt = polyval (phi_coeffs, b_big) * 180 / pi;

endfunction
</pre>
<h2 id="cite"><a class="self-link" href="#cite"></a>
Cite this page
</h2>
<ul>
<li>Text:
<p>
Conway&nbsp;(2019).
<i>Projectile motion: optimal launch angle for weak quadratic drag</i>.
&lt;https://yawnoc.github.io/pages/optimal-angle-weak-drag.html&gt;
[Accessed <span class="date">d&nbsp;month&nbsp;yyyy</span>]
</p>
</li>
<li>BibTeX:
<pre>
@misc{conway-weak-drag,
  author = {Conway},
  year = {2019},
  title = {Projectile motion: optimal launch angle for weak quadratic drag},
  howpublished = {\url{https://yawnoc.github.io/pages/optimal-angle-weak-drag.html}},
  note = {[Accessed <span class="date">d~month~yyyy</span>]}
}
</pre>
</li>
<li>BibLaTeX:
<pre>
@online{conway-weak-drag,
  author = {Conway},
  year = {2019},
  title = {Projectile motion: optimal launch angle for weak quadratic drag},
  url = {https://yawnoc.github.io/pages/optimal-angle-weak-drag.html},
  urldate = {<span class="date">yyyy-mm-dd</span>}
}
</pre>
</li>
</ul>
<footer>
<hr>
©&nbsp;2019&nbsp;Conway.<br>
The code above is released into the
<a href="https://creativecommons.org/publicdomain/zero/1.0/" title="CC0 1.0 Universal (CC0 1.0) Public Domain Dedication">public domain (CC0)</a>.
</footer>
</body>
</html>